
local vocab_cfg = {
    "type":"vocab",
    "path": "./wd/vocab.txt"
    };

local strtensor = {
    "type": "label_sent2tensor",
    "vocab":vocab_cfg,
    "tokenizer":{
        "type": "space_tokenizer"
    }, 
    "max_len": 80, 
    "with_lable":false
};

local reader = {
    "type": "text_line_reader"
};


{
    "type":"lm_trainer",
    "vocab": vocab_cfg,
    "train_dataset":{
        "type": "iter_text_dataset",
        "inputs": "./wd/zh_train.txt", 
        "str2tensor_fn": strtensor,
        "read_fn": reader
    },
    "valid_dataset":{
        "type": "iter_text_dataset",
        "inputs": "./wd/zh_valid.txt", 
        "str2tensor_fn": strtensor,
        "read_fn": reader
    },
   
    "model": {
        "type": "lstm_lm",
        "vocab": vocab_cfg,
        "n_wemb": 256,
        "n_hidden": 256,
        "n_layer": 2
    },
    "out_path":"out"
}
